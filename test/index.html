<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Unit Test Suite | SIPCore.js</title>
  <link rel="stylesheet" href="./js/qunit.css">
  <script src="./js/qunit.js"></script>
  <script src="../deps/require.js"></script>
  <script src="../deps/process.js"></script>
  
  <script>

// load scripts based on QUnit.config
QUnit.config.autostart = false;

// add checkbox for testing minified code
QUnit.config.urlConfig.push({
  id: 'min',
  label: 'Minified source',
  tooltip: 'Load minified source files instead of the regular unminified ones.'
});

// add checkbox for testing code coverage
QUnit.config.urlConfig.push({
  id: 'cov',
  label: 'Code coverage',
  tooltip: 'Load instrumented source files for checking code coverage.'
});


// not working, value undefined - (QUnit.config.min == 'true');
var runCodeCoverage = location.search.indexOf('cov=true') > 0;
var runMinified = !runCodeCoverage && location.search.indexOf('min=true') > 0; 
var libPath = runCodeCoverage ? '../lib-cov' : '../lib';
var libSrc = runMinified ? libPath + '/sip.min' : libPath + '/sip';


// define library under original path
if (runCodeCoverage || runMinified) {

  var SIP = require(libSrc);

  var pathname = resolve(libSrc);
  var fixedPath = pathname
        .replace('/lib-cov/', '/lib/')
        .replace('.min', '');

  cache[fixedPath] = cache[pathname];
  delete cache[pathname];

}

require('./index');
QUnit.start();
  
  </script>
</head>
<body>

  <div id="qunit"></div>

</body>
</html>
